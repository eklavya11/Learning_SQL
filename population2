SELECT * FROM LOCATIONS

SELECT DISTINCT * FROM(
SELECT STATE,
FIRST_VALUE(CITY) OVER(PARTITION BY STATE ORDER BY POPULATION DESC) AS HIGHEST_POPULATION,
LAST_VALUE(CITY) 
OVER(PARTITION BY STATE 
ORDER BY POPULATION DESC
ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
) AS LOWEST_POPULATION
FROM LOCATIONS)A